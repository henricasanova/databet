<template name="Backups">

  <br>

  <div class="ui container center">

    <div class="ui container raised segment">

      <h3 class="ui fluid">Download JSON and uploaded files</h3>
      <form class="ui form">
        <button class="ui button blue" id="button_download_archive"><i class="ui icon download"></i>Download Zipped
          archive
        </button>
      </form>

      {{#if zip_file_requested}}
      {{#if download_button_clicked}}
      {{#if waiting_for_server_download}}
      {{> Loading}}
      {{else}}
      {{#if download_error}}
      <div class="ui message raised red text">
        <b>Download Error: {{server_error}}</b>
      </div>
      {{else}}

      <h3><a href="{{archiveUrl}}?download=true" target="_parent" download>
        Click this link to download the archive
      </a></h3>

      <div class="circular ui icon button red" id="delete_archive">
        <i class="icon delete"></i>
      </div>
      {{/if}}
      {{/if}}
      {{/if}}
      {{/if}}
      <br>

    </div>

    <div class="ui container raised segment">

      <h3 class="ui fluid">Upload JSON</h3>

      <h4>Cut-and-paste JSON below</h4>
      <form class="ui form fluid">
        <div class="ui field">
          <textarea rows=10 id="json_to_upload"> </textarea>
        </div>
      </form>

      <h4>Collections to update:</h4>
      <div class="inline fields">
        {{#each list_of_collections}}
        <div class="ui checkbox">
          <input type="checkbox" id="{{this}}" {{is_checked_by_default}} tabindex="0" class="hidden">
          <label>{{this}}</label>
        </div>
        <br>
        {{/each}}
      </div>

      <h4>Update options</h4>
      <div class="field">
        <div class="ui radio checkbox">
          <input type="radio" name="update_option" id="only_add" checked tabindex="0" class="hidden">
          <label>Only add new documents</label>
        </div>
      </div>
      <div class="field">
        <div class="ui radio checkbox">
          <input type="radio" name="update_option" id="update_all" tabindex="0" class="hidden">
          <label>Add new documents and REPLACE existing documents</label>
        </div>
      </div>

      <br>

      {{#if is_json_parse_error}}
      <div class="ui message raised red text">
        {{{json_parse_error}}}
      </div>
      <br>
      {{/if}}

      {{#if waiting_for_upload}}
      {{> Loading}}
      {{else}}
      {{#if upload_error}}
      <div class="ui message raised red text">
        <b>Upload Errors:</b><br>{{{server_error}}}
      </div>
      {{else}}
      {{#if upload_successful}}
      <div class="ui message raised green text">
        Upload successful - Database updated
      </div>
      {{else}}
      {{/if}}
      <br>
      {{/if}}
      {{/if}}

      <button class="ui button blue" id="button_upload_json"><i class="ui icon upload"></i>Upload JSON</button>

    </div>

  </div>

</template>